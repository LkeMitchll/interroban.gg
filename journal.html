---
layout: layout.html
---

{% assign page = pages | findByID: "5sXnSwGVJePuWZpcOZvIML" %}

<header class="hero | grid">
  <nav>
    <h2>{{ page.fields.title }}</h2>
    <a href="/" class="link">Back</a>
  </nav>
  <section class="measure">
    {% renderMarkdown page.fields.descriptionMarkdown %}
  </section>
</header>

<article class="grid fifty-fifty">
  <section>
    <h2>Recent Posts</h2>
    <ol class="flow gap-large" data-plain>
      {% for post in posts %}
      <li>
        <a href="/post/{{ post.fields.slug }}/">{{ post.fields.title }}</a>
        <p class="color-secondary">
          <time datetime="{{ post.fields.date }}">{{ post.fields.date | formatDate }}</time>
        </p>
      </li>
      {% endfor %}
    </ol>
    <footer>
      <a href="/journal" class="link">See more</a>
    </footer>
  </section>
  <section>
    <h2>What I'm doing now</h2>
    <section>
      {% renderMarkdown now.fields.contentMarkdown %}
    </section>
  </section>
</article>

<article class="grid fifty-fifty">
  <section>
    <h3>Last week</h3>
    <section x-data="{ totals: {}, isLoading: true }" x-init="
      fetch('/api/music/lastweek')
        .then(response =>  response.json())
        .then(json => { isLoading = false; totals = json })">
      <p x-show="isLoading">Loading...</p>
      <p x-show="totals.tracks" x-text="`${totals.tracks} Tracks, from ${totals.albums} Albums`"></p>
    </section>

    <h3>Top tracks (this month)</h3>
    <ul x-data="{ tracks: [], isLoading: true }" x-init="
      fetch('https://warp-co.rs/https://interroban.gg/api/music/top')
        .then(response =>  response.json())
        .then(json => { isLoading = false; tracks = json })">
      <li x-show="isLoading">Loading...</li>
      <template x-for="track in tracks" :key="track.id">
        <li>
          <p x-text="track.title"></p>
          <p x-text="track.album"></p>
          <p x-text="track.artist"></p>
          <img x-bind:src="track.cover.url" width="50" />
        </li>
      </template>
    </ul>
  </section>
  <section></section>
</article>
